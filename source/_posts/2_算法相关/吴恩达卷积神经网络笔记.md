---
title: 吴恩达卷积神经网络笔记
date: 2022-03-01 11:32:38
tags:
    - 算法相关
    - default
categories: 
    - 算法相关
---

吴恩达卷积神经网络笔记

<!-- more -->


[TOC]

# 第一周 卷积神经网络

## 计算及视觉要解决的问题
   - Image Classification
   - Object detection
## 难点
   - 图像计算数据量非常大
   - 所以需要通过卷积减少参数量

## padding

   - valid padding: 不填充
   - same padding：输出和输入一样的size。步长为1时 p=(f-1)/2 ,f为卷积核的大小

## stride（步长）
   - 输出图像大小：floor[(n+2p-f)/s]+1
## 多通道卷积
   - 卷积核的通道数=输入的通道数
   - 一个卷积核将输入映射为单通道图片
   - 卷积核的数量=输出图片的通道数
   - 每个卷积核的bias是一个数
## pooling(池化)
   - max pooling: 只要过滤器检测到了特征，就保留下来
      - 输出的size和padding计算方法一致
      - pooling前后通道数目不变（跟卷积核不一样的地方）
      - 没有参数需要学习
## 使用卷积的意义
   - 参数共享(parameter sharing):
      - 卷积核(过滤器)可通用语图片的各个位置
   - 稀疏连接(sparsity of connections)
      - 卷积后的图片每个像素点只与输入中卷集合大小的像素点有关，与其他像素点无关。这保证图片有平移不变性，即原始图片平移几个像素不太会导致结果的变化

# 第二周 深度卷积网络：实例探究

## 经典网络

- LeNet-5 (1998)
- AlexNet
- VGG
- ResNet
- Inception

## LeNet-5 （1998）

![屏幕快照 2019-11-11 下午3.00.23](吴恩达卷积神经网络笔记.assets/屏幕快照 2019-11-11 下午3.00.23.png)

6w 参数

## AlexNet（2012）

![](吴恩达卷积神经网络笔记.assets/屏幕快照 2019-11-11 下午8.11.06.png)

6kw 参数

## VGG(2015)

用同样大小的卷积核（3*3 ， s=1, padding=same），同样的池化策略

## ResNet(2015)

![屏幕快照 2019-11-11 下午8.20.45](吴恩达卷积神经网络笔记.assets/屏幕快照 2019-11-11 下午8.20.45.png)

随着层数增加，理论上来说损失会减少，但是实际上随着层数增加，对优化算法的要求越高，导致损失上升。

ResNet: $a_{l+1}=g(z(l+1)+a_l)$

##   1*1卷积核

输入图片用1个1*1的卷积核座卷积意义是：输入图片各个通道加权成一个通道

## Inception Network(2014)

![屏幕快照 2019-11-11 下午8.40.29](吴恩达卷积神经网络笔记.assets/屏幕快照 2019-11-11 下午8.40.29.png)

## 迁移学习 transfer learning

冻结前面几层，只训练最后一层全连接层。实现方案之一为：输入通过冻结的几层得到预计算输出，写入硬盘。之后每次从硬盘读入数据，训练最后几层网络，这样不需要每次迭代时都进行前面的计算。

或者只把下载的权重作为初始化，训练整个网络。

## 数据扩充 data augmentation

当数据量不够时。

- 镜像对称
- 随机剪裁
- 色彩转换 color shifting(PCA增强)

## 计算机视觉现状

![屏幕快照 2019-11-11 下午8.56.18](吴恩达卷积神经网络笔记.assets/屏幕快照 2019-11-11 下午8.56.18.png)

数据量越少，人工特征提取越重要。

# 第三周 目标检测

## 目标定位 localization and detection

![屏幕快照 2019-11-12 下午6.32.06](吴恩达卷积神经网络笔记.assets/屏幕快照 2019-11-12 下午6.32.06.png)

- 目标定位：图片中只有一个目标，要定位目标并识别目标。

   实现方法：输出除了类别向量外还有四个数：中心点x,y值，box长度，box高度

- 定义Y

   假设检测目标有三种，图片中最多只会有一个目标物体，则y为：

   $$\left[\begin{matrix}p_c\\b_x\\b_y\\b_h\\b_w\\c_1\\c_2\\c_3\end{matrix}\right]$$

   其中如果图片中有三种中的一种，则$p_c=1 $，$c_1,c_2,c_3$为对应的onehot向量。如果图片中没有目标种类的则$p_c=0$,其他数字为任意值

- loss

   $$loss=\left\{\begin{matrix} \sum_{i=1}^8(y_i-\hat{y_i})^2,\quad if  \quad p_c=1\\ (y_i-\hat{y_i})^2,\quad else \end{matrix}\right.$$

   即如果图片中有目标物体，则loss包含每个y的分量误差。如果没有，则loss只计算$p_c$和预测值的误差。实际上y不同的部分可采用不同的误差，如$p_c$用logistic误差，b用均方误差，c用softmax误差

## 特征点检测

在图片分类的基础上做改造：y第一个元素实$p_c$,其他元素实特征点的坐标值。

体态检测也是一样，只不过特征点是关节点的坐标。要注意的实特征点的顺序需要是一致的。

## 目标检测

- 滑动窗口 sliding window detection

   1. 针对被检测物体（如车）训练图片分类网络
   2. 用不同大小的box扫过目标图片，并输出相应位置的概率

   计算成本很大

## 卷积的滑动窗口实现

- FC层可用卷积实现，具体操作就是卷积核大小与输入相同，卷积核数量与FC的输出层相同。这种卷积表示与全连接的数学实现是一样的

- 将滑动窗口并卷积得到不同box的预测值-->将整张图片进行卷积，最后输出的就是哥哥box对应的概率

- 问题：该方法隐式的预测bounding box的位置，结果不是很准确

   由于box的size是一定的（卷积网络的第一层卷积核大小），移动步长也是一定的(卷积网络的移动步长)

## bounding box预测

- YOLO (you only look once) 2015

   将问题简化为子图上的目标定位问题

   1. 将图片分割，假设分割成3*3的小图
   2. 按照目标定位的方法对每个小图标定8维向量y，由于有9个小图，最终Y为3*3 * 8 的矢量
   3. 按照一般的方法进行训练。
   4. 预测时看每$\hat{Y}$的第一个分量，为1的地方就表示对应的子图有目标物体，对应的$b_i$即为box位置, 对应的$c_i$就是目标物体的种类

   注意：

   1. 标定物体的时候如果物体横跨多个子图，物体只会被分配到一个图上。
   2. 标定$b_i$的时候用的是子图的相对比例坐标。$b_x,b_y$一定小于等于1，$b_x,b_y$可以大于1

- 好处：

   1. bounding box大小和位置不受限制
   2. 只进行单词卷积，而非滑动多次卷积。这是由于滑动卷积过程中有很多计算实可以共享的

## 交并比 intersection over union

用来评价目标检测模型好坏。